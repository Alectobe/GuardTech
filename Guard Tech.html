<!DOCTYPE html>
<html>
<head>
  <title>Таблица CVE из Excel</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
  <style>
     #fileInput {
      padding: 10px 20px;
      background-color: rgb(202, 202, 202);
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 16px;
      padding: 10px;
    }
    #fileInput:hover {
      background-color: rgb(202, 202, 202);

    }
  </style>
  <style>
    table {
    font-family: sans-serif;
    color: white;
    text-align: left;
    border-collapse: separate;
    border-spacing: 5px;
    background-color: rgb(9, 45, 9);
    border: 16px color rgb(202, 202, 202);
    border-radius: 20px;
    padding: 5px;
}
tr {
    font-size: 18px;
    padding: 20px;
}
th {
    background-color: rgb(121, 121, 121);
    border: 10px;
    border-radius: 10px;
    padding: 5px;
}
script {
    background-color: rgb(203, 198, 210);
    border: 10px;
    border-radius: 10px;
    padding: 5px;
}
  </style>
</head>
<body>

<h1><center>Таблица CVE из Excel</center></h1>
<style>
  h1 {
    font-family: sans-serif;
    text-align: left;
    border-collapse: separate;
    color: white;
    border-spacing: 5px;
    background-color: rgb(202, 202, 202);
    border: 16px color rgb(202, 202, 202);
    border-radius: 50px;
    padding: 10px;
  }
  #tableBody {
    background-color: rgb(121, 121, 121);
    border: 10px;
    border-radius: 10px;
    padding: 10px;
  }
</style>
<input type="file" id="fileInput" accept=".xlsx,.xls" onchange="handleFile(this.files)"><br><br>

<table id="cveTable" border="1">
  
  <thead>
    <tr>
      <th><center>CVE</center></th>
      <th><center>Platform</center></th>
      <th><center>Product</center></th>
      <th><center>Link</center></th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <!-- Здесь будут отображаться данные -->
  </tbody>
</table>

<script>
  function handleFile(files) {
    var file = files[0];
    var reader = new FileReader();

    reader.onload = function(e) {
      var data = new Uint8Array(e.target.result);
      var workbook = XLSX.read(data, { type: 'array' });

      var sheetName = workbook.SheetNames[0];
      var sheet = workbook.Sheets[sheetName];

      var table = document.getElementById("cveTable").getElementsByTagName('tbody')[0];
      var range = XLSX.utils.decode_range(sheet['!ref']);

      var startRow = 1;
      var endRow = 100;

      for (var rowNum = startRow; rowNum <= endRow; rowNum++) {
        var newRow = table.insertRow(table.rows.length);

        var columns = [5, 4, 6, 13]; // Индексы столбцов

        for (var i = 0; i < columns.length; i++) {
          var colNum = columns[i];
          var cellAddress = { c: colNum, r: rowNum };
          var cellRef = XLSX.utils.encode_cell(cellAddress);
          var cell = sheet[cellRef];

          var newCell = newRow.insertCell(i);
          newCell.innerHTML = cell ? cell.v : '';
        }
      }
    };

    reader.readAsArrayBuffer(file);
  }
</script>

</body>
</html>
